function f(a,d,c=!1){const b=document.createElement("button");b.onclick=d;b.innerText=a;b.dataset.action=a;b.style.display=c?"none":"";return b}
class h extends HTMLElement{static get observedAttributes(){return"no-headers no-dice-column roll-label clear-label output-dice-column delim glue".split(" ")}constructor(){super();this.h=this.g=null;this.j=1}connectedCallback(){if(this.isConnected){var a=this.querySelectorAll("table");if(0===a.length)console.warn("The <table-roller> element needs to wrap a <table> (e.g. as a child element), but could not find one.");else if(1<a.length)console.warn("The <table-roller> element wraps several tables, which is not supported. Wrap each table separately.");
else{this.g=a[0];a=document.createElement("div");a.style.display="flex";a.style.g="5px";a.append(f(this.v,this.u.bind(this)),f(this.i,this.C.bind(this),!0));this.g.after(a);var d=a.after;this.h=document.createElement("div");d.call(a,this.h);this.j=1}}}get F(){return(this.getAttribute("glue")??"").split(",").map(a=>Number.parseInt(a,10))}get o(){return this.hasAttribute("output-dice-column")}get v(){return this.getAttribute("roll-label")??"Roll"}get i(){return this.getAttribute("clear-label")??"Clear"}get l(){return this.hasAttribute("no-headers")}get m(){return this.hasAttribute("no-dice-column")}get D(){return this.getAttribute("delim")??
" "}get B(){return Array.from(this.g.querySelectorAll(`tr${this.l?"":":not(:first-child)"}`))}get A(){return this.g.querySelectorAll("tr:first-child td").length}get s(){const a=this.A,d=this.B;var c=this.m?0:1;const b=this.F,e=this.D;let g="";for(;c<a;++c)g+=(this.g.querySelector(`tr:nth-child(${1+(Math.floor(Math.random()*d.length)+(this.l?0:1))}) td:nth-child(${1+c})`)?.innerText??"")+(0>b.indexOf(c+1)?e:"");return g}u(){var a=this.h,d=a.append,c=this.s;const b=document.createElement("div"),e=this.o?
`${this.j++}. `:"";b.innerText=`${e} ${c}`;d.call(a,b);this.querySelector(`[data-action="${this.i}"]`).style.display=""}C(){this.h.innerHTML="";this.querySelector(`[data-action="${this.i}"]`).style.display="none";this.j=1}}customElements.define("table-roller",h);
